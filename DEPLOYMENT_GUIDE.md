# üöÄ Mycelium Deployment Guide

–£ —Ç–µ–±—è –µ—Å—Ç—å 3 –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø–æ—Å–æ–±–∞ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å backend:

## 1Ô∏è‚É£ Railway (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) - –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π

### –°–ø–æ—Å–æ–± A: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (2 –º–∏–Ω—É—Ç—ã)
1. –ó–∞–π–¥–∏ –Ω–∞ [railway.app](https://railway.app)
2. –ù–∞–∂–º–∏ **"New Project"**
3. –í—ã–±–µ—Ä–∏ **"Deploy from GitHub repo"** ‚Üí `mycelium_app`
4. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç backend
5. –î–æ–±–∞–≤—å PostgreSQL: –Ω–∞–∂–º–∏ **"+ New"** ‚Üí **"Database"** ‚Üí **"PostgreSQL"**
6. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   ```
   TELEGRAM_BOT_TOKEN=7730788181:AAH6WcpygeX1HhmB-qTi1AzNx8odOVnjjlk
   JWT_SECRET=my-super-secret-jwt-key-2024
   PORT=3000
   NODE_ENV=production
   ```
7. –í **Settings ‚Üí Deploy** —É–∫–∞–∂–∏ **Root Directory**: `server`
8. Railway –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∑–∞ 2-3 –º–∏–Ω—É—Ç—ã!
9. –°–∫–æ–ø–∏—Ä—É–π URL –∏ –æ–±–Ω–æ–≤–∏ `.env` –≤ Flutter

### –°–ø–æ—Å–æ–± B: –ß–µ—Ä–µ–∑ Railway CLI
```bash
# 1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
railway login

# 2. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
cd server
railway init

# 3. –î–æ–±–∞–≤—å PostgreSQL
railway add

# 4. –ó–∞–¥–µ–ø–ª–æ–π
railway up

# 5. –û—Ç–∫—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
railway open
```

–î–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Railway.

---

## 2Ô∏è‚É£ Render.com - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier

1. –ó–∞–π–¥–∏ –Ω–∞ [render.com](https://render.com)
2. –ù–∞–∂–º–∏ **"New +"** ‚Üí **"Blueprint"**
3. –ü–æ–¥–∫–ª—é—á–∏ —Å–≤–æ–π GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
4. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç `render.yaml`
5. –î–æ–±–∞–≤—å **TELEGRAM_BOT_TOKEN** –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
6. –ù–∞–∂–º–∏ **"Apply"**
7. –ü–æ–¥–æ–∂–¥–∏ 5-10 –º–∏–Ω—É—Ç (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier –º–µ–¥–ª–µ–Ω–Ω–µ–µ)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: Render –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∑–∞—Å—ã–ø–∞–µ—Ç –ø–æ—Å–ª–µ 15 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

## 3Ô∏è‚É£ GitHub Actions (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π)

–ï—Å–ª–∏ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å Railway –∞–∫–∫–∞—É–Ω—Ç, –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π:

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω—ã Railway

```bash
# –ó–∞–π–¥–∏ –Ω–∞ Railway
railway login

# –ü–æ–ª—É—á–∏ —Ç–æ–∫–µ–Ω
railway whoami
```

–ò–ª–∏ –∑–∞–π–¥–∏ –Ω–∞ [railway.app/account/tokens](https://railway.app/account/tokens)

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub

1. –ó–∞–π–¥–∏ –≤ **Settings** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. **Secrets and variables** ‚Üí **Actions**
3. –î–æ–±–∞–≤—å —Å–µ–∫—Ä–µ—Ç—ã:
   - `RAILWAY_TOKEN` - —Ç–≤–æ–π Railway API token
   - `RAILWAY_PROJECT_ID` - ID –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–π–¥–∏ –≤ URL –ø—Ä–æ–µ–∫—Ç–∞)

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π

Workflow —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `.github/workflows/deploy-railway.yml`!

–ö–∞–∂–¥—ã–π push –≤ `main` —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ `server/` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç.

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é: **Actions** ‚Üí **Deploy to Railway** ‚Üí **Run workflow**

---

## üì± –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–û–±–Ω–æ–≤–∏ `.env` –≤ Flutter –ø—Ä–æ–µ–∫—Ç–µ:

```env
API_URL=https://—Ç–≤–æ–π-–ø—Ä–æ–µ–∫—Ç.up.railway.app
# –∏–ª–∏
API_URL=https://—Ç–≤–æ–π-–ø—Ä–æ–µ–∫—Ç.onrender.com
```

–ó–∞–∫–æ–º–º–∏—Ç—å –∏ –∑–∞–ø—É—à–∏—Ç—å:
```bash
git add .env
git commit -m "Update API URL"
git push
```

---

## üêõ Troubleshooting

### Railway: "Build failed"
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ Root Directory = `server`
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ `package.json` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏: Settings ‚Üí Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π

### Render: "Database connection failed"
- –ü–æ–¥–æ–∂–¥–∏ 1-2 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ë–î
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `DATABASE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω

### –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
- **"Module not found"**: –ó–∞–ø—É—Å—Ç–∏ `npm install` –ª–æ–∫–∞–ª—å–Ω–æ, –ø—Ä–æ–≤–µ—Ä—å `package.json`
- **"Port already in use"**: –ò–∑–º–µ–Ω–∏ `PORT` –≤ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **"Database error"**: –ó–∞–ø—É—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏—é: Settings ‚Üí Terminal ‚Üí `npx prisma db push`

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | –ü–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω |
|-----------|-----------|--------------|
| Railway   | $5 –≤ –º–µ—Å—è—Ü | $5/–º–µ—Å—è—Ü + usage |
| Render    | ‚úÖ Free tier | $7/–º–µ—Å—è—Ü |
| Vercel    | ‚ùå (—Ç–æ–ª—å–∫–æ frontend) | - |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: Railway –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è full-stack –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
